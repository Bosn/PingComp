<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>PingComp Dashboard</title><link rel="stylesheet" href="/styles.css">  <script src="/theme.js"></script>
</head>
<body><div class="container">
  <div class="header">
    <div class="brand"><img src="/logo.svg" class="logo" alt="logo"><div><h1>PingComp Dashboard</h1><p>线索健康度总览</p></div></div>
    <a class="btn" href="/">进入Leads</a>
  </div>
  <div class="edit-grid">
    <div class="card" style="padding:14px"><div class="muted">总线索</div><h2><%= tot %></h2></div>
    <div class="card" style="padding:14px"><div class="muted">人工锁定</div><h2><%= locked %></h2></div>
    <div class="card" style="padding:14px"><div class="muted">平均潜力分</div><h2><%= avgScore %></h2></div>
    <div class="card" style="padding:14px"><div class="muted">锁定占比</div><h2><%= tot ? Math.round((locked/tot)*100) : 0 %>%</h2></div>
  </div>

  <div class="card" style="padding:14px;margin-top:14px;">
    <h3 style="margin-top:0">按状态分布</h3>
    <% statusRows.forEach(s=> { %>
      <div style="display:flex;justify-content:space-between;border-bottom:1px solid var(--line);padding:8px 0;">
        <span><%= s.lead_status %></span><strong><%= s.c %></strong>
      </div>
    <% }) %>
  </div>

  <div class="card table-wrap" style="margin-top:14px;">
    <table>
      <tr><th>ID</th><th>Name</th><th>Score</th><th>Status</th><th>Locked</th><th>Action</th></tr>
      <% topRows.forEach(r=> { %>
      <tr>
        <td><%= r.id %></td><td><%= r.name %></td><td><%= r.tidb_potential_score ?? '-' %></td><td><%= r.lead_status %></td><td><%= r.manual_locked ? 'Y' : '' %></td>
        <td><a class="btn" href="/edit/<%= r.id %>">编辑</a></td>
      </tr>
      <% }) %>
    </table>
  </div>
</div></body></html>
